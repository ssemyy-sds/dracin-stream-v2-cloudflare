import{c as p,a as w}from"./8_rKqoti.js";import"./DMwq-UN7.js";import{f as I,Q as u,w as m}from"./vbZyT464.js";import{I as F,s as g}from"./BxHs40zU.js";import{l as b,s as y}from"./Dyc3H2TI.js";function x(t,s){const n=b(s,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e=[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"}]];F(t,y({name:"heart"},()=>n,{get iconNode(){return e},children:(o,i)=>{var r=p(),d=I(r);g(d,s,"default",{}),w(o,r)},$$slots:{default:!0}}))}const a="dracin_favorites",k=100;function c(){if(typeof window>"u")return[];try{const t=localStorage.getItem(a);return t?JSON.parse(t).sort((n,e)=>e.addedAt-n.addedAt):[]}catch{return[]}}function f(t){if(typeof window>"u")return[];const s=c();if(s.some(o=>o.bookId===t.bookId))return s;const e=[{...t,addedAt:Date.now()},...s].slice(0,k);try{localStorage.setItem(a,JSON.stringify(e))}catch(o){console.error("Failed to save favorites:",o)}return e}function l(t){if(typeof window>"u")return[];const n=c().filter(e=>e.bookId!==t);try{localStorage.setItem(a,JSON.stringify(n))}catch(e){console.error("Failed to save favorites:",e)}return n}function h(){if(!(typeof window>"u"))try{localStorage.removeItem(a)}catch(t){console.error("Failed to clear favorites:",t)}}function A(){const{subscribe:t,set:s,update:n}=m([]);return{subscribe:t,init:()=>{const e=c();s(e)},add:e=>{n(o=>{if(o.some(d=>d.bookId===e.bookId))return o;const r=[{...e,addedAt:Date.now()},...o].slice(0,100);return f(e),r})},remove:e=>{n(o=>{const i=o.filter(r=>r.bookId!==e);return l(e),i})},toggle:e=>{n(o=>{if(o.some(r=>r.bookId===e.bookId))return l(e.bookId),o.filter(r=>r.bookId!==e.bookId);{const r={...e,addedAt:Date.now()};return f(e),[r,...o].slice(0,100)}})},isFavorite:(e,o)=>o.some(i=>i.bookId===e),clear:()=>{h(),s([])}}}const v=A(),D=u(v,t=>t.length),E=u(v,t=>t.slice(0,10));export{x as H,D as a,v as f,E as r};

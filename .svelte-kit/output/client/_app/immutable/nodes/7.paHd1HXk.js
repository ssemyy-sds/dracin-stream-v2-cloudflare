import{c as ee,a as f,d as Ct,f as y,s as k,e as de}from"../chunks/8_rKqoti.js";import{o as Vt}from"../chunks/QNYzxUZg.js";import{f as Q,p as Ht,s as m,c as rt,u as st,g as e,d as r,e as Qt,i as ce,j as Bt,$ as Kt,l as a,r as t,k as o,n as ve,t as D,A as Rt}from"../chunks/vbZyT464.js";import{l as we,s as ke,i as E,a as Xt,b as ot}from"../chunks/Dyc3H2TI.js";import{I as je,s as Te,f as lt,a as ue,b as J,d as Gt,e as it,i as nt}from"../chunks/BxHs40zU.js";import{h as Jt,P as Wt}from"../chunks/B6TXjWgC.js";import{b as Yt}from"../chunks/DdS--3oo.js";import{p as Zt}from"../chunks/Ct-MbXlx.js";import{g as ea}from"../chunks/DZxOtlE5.js";import{a as ta,b as aa,f as ra}from"../chunks/BqKEiSpK.js";import{H as sa,f as dt}from"../chunks/BNiMAG_W.js";import{L as ct}from"../chunks/DXiVI5Ws.js";import"../chunks/DMwq-UN7.js";import{X as Ue}from"../chunks/D-6aa0M8.js";function oa(M,P){const S=we(P,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"m6 9 6 6 6-6"}]];je(M,ke({name:"chevron-down"},()=>S,{get iconNode(){return z},children:(L,te)=>{var j=ee(),I=Q(j);Te(I,P,"default",{}),f(L,j)},$$slots:{default:!0}}))}function la(M,P){const S=we(P,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"m18 15-6-6-6 6"}]];je(M,ke({name:"chevron-up"},()=>S,{get iconNode(){return z},children:(L,te)=>{var j=ee(),I=Q(j);Te(I,P,"default",{}),f(L,j)},$$slots:{default:!0}}))}function ia(M,P){const S=we(P,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["circle",{cx:"12",cy:"12",r:"10"}],["path",{d:"M12 16v-4"}],["path",{d:"M12 8h.01"}]];je(M,ke({name:"info"},()=>S,{get iconNode(){return z},children:(L,te)=>{var j=ee(),I=Q(j);Te(I,P,"default",{}),f(L,j)},$$slots:{default:!0}}))}function na(M,P){const S=we(P,["children","$$slots","$$events","$$legacy"]);/**
 * @license lucide-svelte v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=[["path",{d:"M3 12h.01"}],["path",{d:"M3 18h.01"}],["path",{d:"M3 6h.01"}],["path",{d:"M8 12h13"}],["path",{d:"M8 18h13"}],["path",{d:"M8 6h13"}]];je(M,ke({name:"list"},()=>S,{get iconNode(){return z},children:(L,te)=>{var j=ee(),I=Q(j);Te(I,P,"default",{}),f(L,j)},$$slots:{default:!0}}))}var da=y('<div class="flex items-center justify-center"><!></div>'),ca=y('<div class="flex flex-col items-center justify-center text-center px-4"><h2 class="text-2xl font-bold mb-2">Error</h2> <p class="text-gray-400 mb-6"> </p> <a href="/" class="px-6 py-3 bg-brand-orange rounded-full font-semibold">Kembali ke Home</a></div>'),va=y('<div class="absolute inset-0 flex items-center justify-center bg-black/50"><!></div>'),ua=y('<button class="absolute inset-0 flex items-center justify-center"><div class="w-20 h-20 rounded-full bg-brand-orange/80 flex items-center justify-center backdrop-blur-sm"><!></div></button>'),fa=y('<div class="absolute top-0 left-0 right-0 flex items-center justify-center p-4 pt-20 bg-gradient-to-b from-black/80 to-transparent z-10 transition-opacity duration-300"><div class="text-center"><p class="text-sm font-semibold line-clamp-1"> </p> <p class="text-xs text-gray-400"> </p></div></div>'),pa=y('<button class="flex flex-col items-center gap-1"><div><span class="text-xs font-bold"> </span></div> <span class="text-xs">Quality</span></button>'),ba=y('<div class="absolute right-4 bottom-32 flex flex-col items-center gap-5 z-20 transition-opacity duration-300"><button class="flex flex-col items-center gap-1 disabled:opacity-30"><div class="w-12 h-12 rounded-full glass flex items-center justify-center"><!></div> <span class="text-xs">Prev</span></button> <button class="flex flex-col items-center gap-1"><div><!></div> <span class="text-xs"> </span></button> <button class="flex flex-col items-center gap-1"><div><!></div> <span class="text-xs"> </span></button> <button class="flex flex-col items-center gap-1"><div><!></div> <span class="text-xs">Info</span></button> <!> <button class="flex flex-col items-center gap-1 disabled:opacity-30"><div class="w-12 h-12 rounded-full glass flex items-center justify-center"><!></div> <span class="text-xs">Next</span></button> <button class="flex flex-col items-center gap-1"><div><span class="text-xs font-bold">AUTO</span></div> <span class="text-xs"> </span></button></div>'),_a=y('<div class="absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/80 to-transparent z-10 transition-opacity duration-300"><div class="relative h-1 bg-white/30 rounded-full mb-3 cursor-pointer"><div class="absolute top-0 left-0 h-full bg-brand-orange rounded-full transition-all"></div></div> <div class="flex items-center justify-between text-xs text-gray-300"><span> </span> <span> </span></div></div>'),ma=y('<p class="text-gray-400 mb-4"> </p> <div class="flex gap-3 justify-center"><button class="px-6 py-3 glass rounded-full font-semibold hover:bg-white/20 transition-colors">Batal</button> <button class="px-6 py-3 bg-brand-orange rounded-full font-semibold hover:bg-brand-orange/80 transition-colors">Putar Sekarang</button></div>',1),ga=y('<p class="text-gray-400 mb-4"> </p> <div class="flex gap-3 justify-center"><button class="px-6 py-3 glass rounded-full font-semibold hover:bg-white/20 transition-colors">Tutup</button> <button class="px-6 py-3 bg-brand-orange rounded-full font-semibold hover:bg-brand-orange/80 transition-colors">Episode Selanjutnya</button></div>',1),xa=y('<div class="absolute inset-0 flex items-center justify-center bg-black/80 backdrop-blur-sm z-40"><div class="text-center p-6"><h3 class="text-lg font-semibold mb-2">Episode selesai!</h3> <!></div></div>'),ha=y("<button> </button>"),ya=y('<div class="absolute inset-0 pt-16 bg-black/90 backdrop-blur-sm flex flex-col z-30"><div class="flex items-center justify-between p-4 border-b border-white/10"><h3 class="font-semibold">Daftar Episode</h3> <button class="p-2"><!></button></div> <div class="flex-1 overflow-y-auto p-4"><div class="grid grid-cols-5 gap-2"></div></div></div>'),$a=y('<div class="absolute inset-0 pt-16 bg-black/90 backdrop-blur-sm flex flex-col z-30"><div class="flex items-center justify-between p-4 border-b border-white/10"><h3 class="font-semibold">Detail Drama</h3> <button class="p-2"><!></button></div> <div class="flex-1 overflow-y-auto p-4"><div class="flex gap-4 mb-4"><img class="w-24 h-36 object-cover rounded-lg"/> <div class="flex-1"><h2 class="text-lg font-bold mb-2"> </h2> <p class="text-sm text-gray-400 mb-1"> </p> <p class="text-sm text-gray-400"> </p></div></div> <p class="text-sm text-gray-300 leading-relaxed"> </p> <a class="inline-block mt-4 px-4 py-2 bg-brand-orange rounded-lg text-sm font-medium">Lihat Detail Lengkap</a></div></div>'),wa=y("<button> </button>"),ka=y('<div class="absolute inset-0 pt-16 bg-black/90 backdrop-blur-sm flex flex-col z-30"><div class="flex items-center justify-between p-4 border-b border-white/10"><h3 class="font-semibold">Pilih Kualitas Video</h3> <button class="p-2"><!></button></div> <div class="flex-1 flex flex-col items-center justify-center p-4 gap-3"></div></div>'),ja=y('<div class="relative w-full h-full"><video class="w-full h-full object-contain bg-black" playsinline=""></video> <!> <!> <!> <!> <!> <!> <!> <!> <!></div>',2),Ta=y('<div class="fixed inset-0 bg-black flex items-center justify-center"><!></div>');function Ca(M,P){Ht(P,!0);const S=()=>ot(Zt,"$page",L),z=()=>ot(dt,"$favorites",L),[L,te]=Xt();let j=ce(()=>S().params.id),I=ce(()=>S().url.searchParams.get("ep")),$=m(1),x=m(null),q=m(rt([])),vt=m(""),fe=m(rt([])),Ne=m(!0),pe=m(!1),C=m(!1),B=m(!1),V=m(!1),be=m(540),K=m(null),R=m(!0),W=m(!1),_e=m(5),d,A=m(!1),Oe=m(0),Ee=m(0),ae=m(0),X=m(!0),me,re=m(!0),se,ge=m(null),Pe=ce(()=>e(x)?z().some(n=>n.bookId===e(x).bookId):!1);st(()=>{e(I)&&r($,parseInt(e(I))||1,!0)}),Vt(async()=>{await ut()}),st(()=>{if(d&&e(ge)){const n=e(ge);r(ge,null),d.src=n,d.load(),d.oncanplay=()=>{d.play().catch(()=>{console.log("Autoplay blocked")})}}});async function ut(){r(Ne,!0),r(K,null);try{const[n,c]=await Promise.all([ta(e(j)),aa(e(j))]);r(x,n,!0),r(q,c,!0),e(I)&&r($,parseInt(e(I))||1,!0),await Ce(e($))}catch(n){console.error("Failed to load drama:",n),r(K,"Failed to load drama")}finally{r(Ne,!1)}}async function Ce(n){r(pe,!0);try{const c=await ra(e(j),n);r(fe,c,!0);const w=c.find(G=>G.quality===540)||c.find(G=>G.isDefault)||c.find(G=>G.quality===720)||c[0];w?(r(vt,w.videoUrl,!0),r(be,w.quality,!0),d?(d.src=w.videoUrl,d.load(),d.oncanplay=()=>{d.play().catch(()=>{console.log("Autoplay blocked")})}):r(ge,w.videoUrl,!0)):r(K,"No video source available")}catch(c){console.error("Failed to load episode:",c),r(K,"Failed to load episode")}finally{r(pe,!1)}}function Ie(n){r($,n,!0),ea(`/watch/${e(j)}?ep=${n}`,{replaceState:!0}),Ce(n),r(C,!1)}function ft(){e($)>1&&Ie(e($)-1)}function Ve(){e($)<e(q).length&&Ie(e($)+1)}function pt(){e(x)&&dt.toggle(e(x))}function bt(n){const c=e(fe).find(w=>w.quality===n);if(c&&d){const w=d.currentTime;d.src=c.videoUrl,d.currentTime=w,r(be,n,!0),r(V,!1),e(A)&&d.play()}}function He(){d&&(d.paused?d.play():d.pause())}function _t(){He(),r(X,!0),r(re,!0),clearTimeout(me),clearTimeout(se),me=setTimeout(()=>{e(A)&&r(X,!1)},3e3),se=setTimeout(()=>{e(A)&&r(re,!1)},5e3)}function mt(){d&&(r(Ee,d.currentTime,!0),r(ae,d.duration||0,!0),r(Oe,e(ae)?e(Ee)/e(ae)*100:0,!0))}function gt(n){if(d){const c=n.currentTarget.getBoundingClientRect(),w=(n.clientX-c.left)/c.width;d.currentTime=w*e(ae)}}function Qe(n){if(!n||isNaN(n))return"0:00";const c=Math.floor(n/60),w=Math.floor(n%60);return`${c}:${w.toString().padStart(2,"0")}`}function xt(){r(A,!0),r(X,!1),clearTimeout(me),clearTimeout(se),se=setTimeout(()=>{r(re,!1)},5e3)}function ht(){r(A,!1),r(X,!0),r(re,!0),clearTimeout(me),clearTimeout(se)}let F;function yt(){if(e($)>=e(q).length){r(X,!0);return}e(R)?(r(_e,5),r(W,!0),F&&clearInterval(F),F=setInterval(()=>{Rt(_e,-1),e(_e)<=0&&(F&&clearInterval(F),De())},1e3)):r(W,!0)}function $t(){F&&clearInterval(F),r(W,!1)}function De(){F&&clearInterval(F),r(W,!1),Ve()}var Se=Ta();Jt("1oiicp0",n=>{Bt(()=>{Kt.title=`${e(x)?`${e(x).bookName} - Episode ${e($)}`:"Loading..."} - DRACIN`})});var wt=a(Se);{var kt=n=>{var c=da(),w=a(c);ct(w,{class:"w-12 h-12 text-brand-orange animate-spin"}),t(c),f(n,c)},jt=n=>{var c=ee(),w=Q(c);{var G=Y=>{var Z=ca(),xe=o(a(Z),2),Le=a(xe,!0);t(xe),ve(2),t(Z),D(()=>k(Le,e(K))),f(Y,Z)},Tt=Y=>{var Z=ee(),xe=Q(Z);{var Le=Me=>{var ze=ja(),U=a(ze);U.__click=_t,Yt(U,s=>d=s,()=>d);var Be=o(U,2);{var Nt=s=>{var l=va(),i=a(l);ct(i,{class:"w-12 h-12 text-brand-orange animate-spin"}),t(l),f(s,l)};E(Be,s=>{e(pe)&&s(Nt)})}var Ke=o(Be,2);{var Et=s=>{var l=ua();l.__click=He;var i=a(l),v=a(i);Wt(v,{class:"w-10 h-10 text-white fill-white ml-1"}),t(i),t(l),f(s,l)};E(Ke,s=>{!e(A)&&!e(pe)&&s(Et)})}var Re=o(Ke,2);{var Pt=s=>{var l=fa(),i=a(l),v=a(i),N=a(v,!0);t(v);var p=o(v,2),u=a(p);t(p),t(i),t(l),D(()=>{k(N,e(x).bookName),k(u,`Episode ${e($)??""} / ${e(q).length??""}`)}),f(s,l)};E(Re,s=>{(e(X)||!e(A))&&s(Pt)})}var Xe=o(Re,2);{var It=s=>{var l=ba(),i=a(l);i.__click=ft;var v=a(i),N=a(v);la(N,{class:"w-6 h-6"}),t(v),ve(2),t(i);var p=o(i,2);p.__click=()=>{r(C,!e(C)),r(B,!1),r(V,!1)};var u=a(p),b=a(u);na(b,{class:"w-6 h-6"}),t(u);var _=o(u,2),T=a(_);t(_),t(p);var h=o(p,2);h.__click=pt;var g=a(h),O=a(g);{let ne=ce(()=>e(Pe)?"fill-white":"");sa(O,{get class(){return`w-6 h-6 ${e(ne)??""}`}})}t(g);var oe=o(g,2),qe=a(oe,!0);t(oe),t(h);var H=o(h,2);H.__click=()=>{r(B,!e(B)),r(C,!1),r(V,!1)};var le=a(H),Ae=a(le);ia(Ae,{class:"w-6 h-6"}),t(le),ve(2),t(H);var he=o(H,2);{var At=ne=>{var $e=pa();$e.__click=()=>{r(V,!e(V)),r(B,!1),r(C,!1)};var Fe=a($e),at=a(Fe),Ot=a(at);t(at),t(Fe),ve(2),t($e),D(()=>{J(Fe,1,`w-12 h-12 rounded-full glass flex items-center justify-center ${e(V)?"bg-brand-orange":""}`),k(Ot,`${e(be)??""}p`)}),f(ne,$e)};E(he,ne=>{e(fe).length>1&&ne(At)})}var ie=o(he,2);ie.__click=Ve;var Ze=a(ie),Ft=a(Ze);oa(Ft,{class:"w-6 h-6"}),t(Ze),ve(2),t(ie);var ye=o(ie,2);ye.__click=()=>r(R,!e(R));var et=a(ye),tt=o(et,2),Ut=a(tt,!0);t(tt),t(ye),t(l),D(()=>{i.disabled=e($)<=1,J(u,1,`w-12 h-12 rounded-full glass flex items-center justify-center ${e(C)?"bg-brand-orange":""}`),k(T,`${e(q).length??""} Ep`),J(g,1,`w-12 h-12 rounded-full glass flex items-center justify-center ${e(Pe)?"bg-red-500":""}`),k(qe,e(Pe)?"Saved":"Save"),J(le,1,`w-12 h-12 rounded-full glass flex items-center justify-center ${e(B)?"bg-brand-orange":""}`),ie.disabled=e($)>=e(q).length,ue(ye,"title",e(R)?"Auto-play ON":"Auto-play OFF"),J(et,1,`w-12 h-12 rounded-full glass flex items-center justify-center ${e(R)?"bg-green-500":""}`),k(Ut,e(R)?"On":"Off")}),f(s,l)};E(Xe,s=>{(e(re)||!e(A))&&s(It)})}var Ge=o(Xe,2);{var Dt=s=>{var l=_a(),i=a(l);i.__click=gt;var v=a(i);t(i);var N=o(i,2),p=a(N),u=a(p,!0);t(p);var b=o(p,2),_=a(b,!0);t(b),t(N),t(l),D((T,h)=>{Gt(v,`width: ${e(Oe)??""}%`),k(u,T),k(_,h)},[()=>Qe(e(Ee)),()=>Qe(e(ae))]),f(s,l)};E(Ge,s=>{(e(X)||!e(A))&&s(Dt)})}var Je=o(Ge,2);{var St=s=>{var l=xa(),i=a(l),v=o(a(i),2);{var N=u=>{var b=ma(),_=Q(b),T=a(_);t(_);var h=o(_,2),g=a(h);g.__click=$t;var O=o(g,2);O.__click=De,t(h),D(()=>k(T,`Lanjut ke Episode ${e($)+1} dalam ${e(_e)??""}
                                detik...`)),f(u,b)},p=u=>{var b=ga(),_=Q(b),T=a(_);t(_);var h=o(_,2),g=a(h);g.__click=()=>r(W,!1);var O=o(g,2);O.__click=De,t(h),D(()=>k(T,`Lanjutkan ke Episode ${e($)+1}?`)),f(u,b)};E(v,u=>{e(R)?u(N):u(p,!1)})}t(i),t(l),f(s,l)};E(Je,s=>{e(W)&&e($)<e(q).length&&s(St)})}var We=o(Je,2);{var Lt=s=>{var l=ya(),i=a(l),v=o(a(i),2);v.__click=()=>r(C,!1);var N=a(v);Ue(N,{class:"w-5 h-5"}),t(v),t(i);var p=o(i,2),u=a(p);it(u,21,()=>e(q),nt,(b,_,T)=>{const h=ce(()=>T+1);var g=ha();g.__click=()=>Ie(e(h));var O=a(g,!0);t(g),D(()=>{J(g,1,`p-3 rounded-lg text-sm font-medium transition-colors ${e($)===e(h)?"bg-brand-orange":"glass hover:bg-white/20"}`),k(O,e(h))}),f(b,g)}),t(u),t(p),t(l),f(s,l)};E(We,s=>{e(C)&&s(Lt)})}var Ye=o(We,2);{var Mt=s=>{var l=$a(),i=a(l),v=o(a(i),2);v.__click=()=>r(B,!1);var N=a(v);Ue(N,{class:"w-5 h-5"}),t(v),t(i);var p=o(i,2),u=a(p),b=a(u),_=o(b,2),T=a(_),h=a(T,!0);t(T);var g=o(T,2),O=a(g);t(g);var oe=o(g,2),qe=a(oe);t(oe),t(_),t(u);var H=o(u,2),le=a(H,!0);t(H);var Ae=o(H,2);t(p),t(l),D(he=>{ue(b,"src",he),ue(b,"alt",e(x).bookName),k(h,e(x).bookName),k(O,`${e(x).status??""} â€¢ ${e(x).year??""}`),k(qe,`${e(q).length??""} Episodes`),k(le,e(x).introduction||"No description available."),ue(Ae,"href",`/detail/${e(x).bookId??""}`)},[()=>lt(e(x).cover)]),f(s,l)};E(Ye,s=>{e(B)&&s(Mt)})}var zt=o(Ye,2);{var qt=s=>{var l=ka(),i=a(l),v=o(a(i),2);v.__click=()=>r(V,!1);var N=a(v);Ue(N,{class:"w-5 h-5"}),t(v),t(i);var p=o(i,2);it(p,21,()=>e(fe),nt,(u,b)=>{var _=wa();_.__click=()=>bt(e(b).quality);var T=a(_);t(_),D(()=>{J(_,1,`w-full max-w-xs px-6 py-4 rounded-xl text-center font-semibold transition-colors ${e(be)===e(b).quality?"bg-brand-orange":"glass hover:bg-white/20"}`),k(T,`${e(b).quality??""}p ${e(b).quality>=1080?"(HD)":e(b).quality>=720?"(SD)":""}`)}),f(u,_)}),t(p),t(l),f(s,l)};E(zt,s=>{e(V)&&s(qt)})}t(ze),D(s=>ue(U,"poster",s),[()=>lt(e(x).cover)]),de("play",U,xt),de("pause",U,ht),de("timeupdate",U,mt),de("ended",U,yt),de("error",U,()=>{r(K,"Failed to load video")}),f(Me,ze)};E(xe,Me=>{e(x)&&Me(Le)},!0)}f(Y,Z)};E(w,Y=>{e(K)&&!e(x)?Y(G):Y(Tt,!1)},!0)}f(n,c)};E(wt,n=>{e(Ne)?n(kt):n(jt,!1)})}t(Se),f(M,Se),Qt(),te()}Ct(["click"]);export{Ca as component};
